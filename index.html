<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>L√§r dig Svenska ‚Äî SFI Learning Hub</title>
<link href="https://fonts.googleapis.com/css2?family=DM+Serif+Display:ital@0;1&family=Outfit:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --blue: #005B99;
  --blue-light: #E8F4FD;
  --blue-dark: #003D66;
  --yellow: #FECC02;
  --yellow-light: #FFF8D6;
  --yellow-dark: #D4A800;
  --forest: #2D5A3D;
  --forest-light: #E8F5EC;
  --warm: #FAF7F2;
  --warm-dark: #F0EBE1;
  --text: #1A1A2E;
  --text-light: #5A5A7A;
  --white: #FFFFFF;
  --correct: #2D8B4E;
  --correct-bg: #E8F8EE;
  --wrong: #C0392B;
  --wrong-bg: #FDE8E6;
  --radius: 12px;
  --shadow: 0 2px 12px rgba(0,0,0,0.06);
  --shadow-lg: 0 8px 32px rgba(0,0,0,0.1);
}

* { margin: 0; padding: 0; box-sizing: border-box; }

body {
  font-family: 'Outfit', sans-serif;
  background: var(--warm);
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* ‚îÄ‚îÄ‚îÄ HEADER ‚îÄ‚îÄ‚îÄ */
.header {
  background: var(--blue-dark);
  color: white;
  padding: 0;
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: 0 4px 20px rgba(0,0,0,0.15);
}

.header-top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 16px 32px;
  max-width: 1400px;
  margin: 0 auto;
}

.logo {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
}

.logo-flag {
  width: 42px;
  height: 28px;
  background: var(--blue);
  border-radius: 4px;
  position: relative;
  overflow: hidden;
  border: 1px solid rgba(255,255,255,0.2);
}

.logo-flag::before {
  content: '';
  position: absolute;
  left: 12px; top: 0;
  width: 7px; height: 100%;
  background: var(--yellow);
}

.logo-flag::after {
  content: '';
  position: absolute;
  left: 0; top: 10px;
  width: 100%; height: 7px;
  background: var(--yellow);
}

.logo h1 {
  font-family: 'DM Serif Display', serif;
  font-size: 1.5rem;
  font-weight: 400;
  letter-spacing: -0.02em;
}

.logo h1 span {
  color: var(--yellow);
}

.header-stats {
  display: flex;
  align-items: center;
  gap: 20px;
  font-size: 0.85rem;
  font-weight: 500;
}

.stat-badge {
  display: flex;
  align-items: center;
  gap: 6px;
  background: rgba(255,255,255,0.1);
  padding: 6px 14px;
  border-radius: 20px;
}

.stat-badge .icon { font-size: 1rem; }

/* ‚îÄ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ‚îÄ */
.nav {
  display: flex;
  gap: 0;
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 32px;
}

.nav-tab {
  padding: 12px 24px;
  background: none;
  border: none;
  color: rgba(255,255,255,0.6);
  font-family: 'Outfit', sans-serif;
  font-size: 0.9rem;
  font-weight: 500;
  cursor: pointer;
  border-bottom: 3px solid transparent;
  transition: all 0.2s;
}

.nav-tab:hover {
  color: rgba(255,255,255,0.9);
  background: rgba(255,255,255,0.05);
}

.nav-tab.active {
  color: white;
  border-bottom-color: var(--yellow);
}

/* ‚îÄ‚îÄ‚îÄ HERO / HOME ‚îÄ‚îÄ‚îÄ */
.hero {
  background: linear-gradient(135deg, var(--blue) 0%, var(--blue-dark) 100%);
  padding: 80px 32px;
  text-align: center;
  color: white;
  position: relative;
  overflow: hidden;
}

.hero::before {
  content: '';
  position: absolute;
  top: -50%; left: -50%;
  width: 200%; height: 200%;
  background: radial-gradient(circle at 30% 40%, rgba(254,204,2,0.08) 0%, transparent 50%),
              radial-gradient(circle at 70% 60%, rgba(255,255,255,0.04) 0%, transparent 50%);
  animation: heroFloat 20s ease-in-out infinite;
}

@keyframes heroFloat {
  0%, 100% { transform: translate(0, 0); }
  50% { transform: translate(-20px, -10px); }
}

.hero-content { position: relative; z-index: 1; max-width: 700px; margin: 0 auto; }

.hero h2 {
  font-family: 'DM Serif Display', serif;
  font-size: 3.2rem;
  font-weight: 400;
  line-height: 1.15;
  margin-bottom: 16px;
}

.hero h2 em {
  font-style: italic;
  color: var(--yellow);
}

.hero p {
  font-size: 1.15rem;
  opacity: 0.85;
  line-height: 1.6;
  margin-bottom: 32px;
}

.hero-levels {
  display: flex;
  gap: 16px;
  justify-content: center;
  flex-wrap: wrap;
}

.level-card {
  background: rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.15);
  border-radius: var(--radius);
  padding: 24px 28px;
  cursor: pointer;
  transition: all 0.3s;
  text-align: left;
  min-width: 160px;
}

.level-card:hover {
  background: rgba(255,255,255,0.18);
  transform: translateY(-4px);
  box-shadow: 0 12px 40px rgba(0,0,0,0.2);
}

.level-card .level-letter {
  font-family: 'DM Serif Display', serif;
  font-size: 2rem;
  color: var(--yellow);
}

.level-card .level-name {
  font-size: 0.85rem;
  opacity: 0.8;
  margin-top: 4px;
}

.level-card .level-desc {
  font-size: 0.75rem;
  opacity: 0.6;
  margin-top: 8px;
  line-height: 1.4;
}

/* ‚îÄ‚îÄ‚îÄ MAIN CONTENT ‚îÄ‚îÄ‚îÄ */
.main {
  max-width: 1100px;
  margin: 0 auto;
  padding: 40px 32px 80px;
}

.section-header {
  margin-bottom: 32px;
}

.section-header h2 {
  font-family: 'DM Serif Display', serif;
  font-size: 2rem;
  margin-bottom: 8px;
}

.section-header p {
  color: var(--text-light);
  font-size: 1rem;
}

.breadcrumb {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 0.85rem;
  color: var(--text-light);
  margin-bottom: 24px;
}

.breadcrumb a {
  color: var(--blue);
  text-decoration: none;
  cursor: pointer;
}

.breadcrumb a:hover { text-decoration: underline; }

/* ‚îÄ‚îÄ‚îÄ LEVEL GRID ‚îÄ‚îÄ‚îÄ */
.topic-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap: 20px;
}

.topic-card {
  background: white;
  border-radius: var(--radius);
  padding: 28px;
  cursor: pointer;
  transition: all 0.25s;
  border: 1px solid rgba(0,0,0,0.06);
  box-shadow: var(--shadow);
  position: relative;
  overflow: hidden;
}

.topic-card::before {
  content: '';
  position: absolute;
  top: 0; left: 0;
  width: 4px; height: 100%;
  background: var(--blue);
  opacity: 0;
  transition: opacity 0.25s;
}

.topic-card:hover {
  transform: translateY(-3px);
  box-shadow: var(--shadow-lg);
}

.topic-card:hover::before { opacity: 1; }

.topic-card .topic-icon {
  font-size: 2rem;
  margin-bottom: 12px;
}

.topic-card h3 {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 6px;
}

.topic-card p {
  font-size: 0.85rem;
  color: var(--text-light);
  line-height: 1.5;
}

.topic-card .topic-meta {
  display: flex;
  gap: 12px;
  margin-top: 16px;
  font-size: 0.75rem;
  color: var(--text-light);
}

.topic-card .topic-meta span {
  background: var(--warm);
  padding: 4px 10px;
  border-radius: 12px;
}

/* ‚îÄ‚îÄ‚îÄ LESSON VIEW ‚îÄ‚îÄ‚îÄ */
.lesson-container {
  display: grid;
  grid-template-columns: 280px 1fr;
  gap: 32px;
  align-items: start;
}

@media (max-width: 800px) {
  .lesson-container { grid-template-columns: 1fr; }
}

.lesson-sidebar {
  background: white;
  border-radius: var(--radius);
  padding: 24px;
  box-shadow: var(--shadow);
  position: sticky;
  top: 110px;
}

.lesson-sidebar h3 {
  font-size: 0.9rem;
  font-weight: 600;
  margin-bottom: 16px;
  color: var(--text-light);
  text-transform: uppercase;
  letter-spacing: 0.05em;
}

.sidebar-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 0.88rem;
  transition: all 0.15s;
  margin-bottom: 4px;
}

.sidebar-item:hover { background: var(--warm); }
.sidebar-item.active { background: var(--blue-light); color: var(--blue); font-weight: 600; }
.sidebar-item.completed { color: var(--correct); }
.sidebar-item .check { font-size: 0.8rem; }

.lesson-content {
  background: white;
  border-radius: var(--radius);
  padding: 40px;
  box-shadow: var(--shadow);
  min-height: 500px;
}

.lesson-content h2 {
  font-family: 'DM Serif Display', serif;
  font-size: 1.8rem;
  margin-bottom: 8px;
}

.lesson-content .subtitle {
  color: var(--text-light);
  margin-bottom: 32px;
  font-size: 0.95rem;
}

/* ‚îÄ‚îÄ‚îÄ VOCABULARY TABLE ‚îÄ‚îÄ‚îÄ */
.vocab-table {
  width: 100%;
  border-collapse: collapse;
  margin: 24px 0;
}

.vocab-table th {
  text-align: left;
  padding: 12px 16px;
  background: var(--warm);
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: var(--text-light);
  font-weight: 600;
}

.vocab-table td {
  padding: 14px 16px;
  border-bottom: 1px solid var(--warm-dark);
  font-size: 0.95rem;
}

.vocab-table .swedish {
  font-weight: 600;
  color: var(--blue-dark);
}

.vocab-table .pronunciation {
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.82rem;
  color: var(--text-light);
}

.vocab-table tr:hover td { background: var(--blue-light); }

.audio-btn {
  background: var(--blue-light);
  border: none;
  width: 32px; height: 32px;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 0.9rem;
  transition: all 0.15s;
}

.audio-btn:hover { background: var(--blue); color: white; }

/* ‚îÄ‚îÄ‚îÄ EXERCISE COMPONENTS ‚îÄ‚îÄ‚îÄ */
.exercise-block {
  background: var(--warm);
  border-radius: var(--radius);
  padding: 32px;
  margin: 24px 0;
}

.exercise-block h3 {
  font-size: 1.1rem;
  font-weight: 600;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.exercise-block .instructions {
  color: var(--text-light);
  font-size: 0.9rem;
  margin-bottom: 20px;
}

.exercise-question {
  background: white;
  border-radius: 10px;
  padding: 24px;
  margin-bottom: 16px;
  border: 2px solid transparent;
  transition: border-color 0.3s;
}

.exercise-question.correct { border-color: var(--correct); background: var(--correct-bg); }
.exercise-question.wrong { border-color: var(--wrong); background: var(--wrong-bg); }

.exercise-question .q-text {
  font-size: 1.05rem;
  font-weight: 500;
  margin-bottom: 16px;
}

.exercise-question .q-text .blank {
  display: inline-block;
  min-width: 120px;
  border-bottom: 2px dashed var(--blue);
  text-align: center;
  padding: 2px 8px;
  font-family: 'JetBrains Mono', monospace;
  color: var(--blue);
}

.options-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 10px;
}

.option-btn {
  padding: 12px 16px;
  background: var(--warm);
  border: 2px solid var(--warm-dark);
  border-radius: 8px;
  font-family: 'Outfit', sans-serif;
  font-size: 0.95rem;
  cursor: pointer;
  transition: all 0.15s;
  text-align: left;
}

.option-btn:hover { border-color: var(--blue); background: var(--blue-light); }
.option-btn.selected { border-color: var(--blue); background: var(--blue-light); font-weight: 600; }
.option-btn.correct-answer { border-color: var(--correct); background: var(--correct-bg); }
.option-btn.wrong-answer { border-color: var(--wrong); background: var(--wrong-bg); }
.option-btn:disabled { cursor: default; opacity: 0.7; }

.text-input {
  width: 100%;
  padding: 14px 16px;
  border: 2px solid var(--warm-dark);
  border-radius: 8px;
  font-family: 'Outfit', sans-serif;
  font-size: 1rem;
  transition: border-color 0.2s;
  background: white;
}

.text-input:focus { outline: none; border-color: var(--blue); }

.feedback {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 16px;
  border-radius: 8px;
  margin-top: 12px;
  font-size: 0.9rem;
  font-weight: 500;
  animation: fadeIn 0.3s;
}

.feedback.correct { background: var(--correct-bg); color: var(--correct); }
.feedback.wrong { background: var(--wrong-bg); color: var(--wrong); }

@keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

/* ‚îÄ‚îÄ‚îÄ DIALOGUE BOX ‚îÄ‚îÄ‚îÄ */
.dialogue-box {
  background: white;
  border-radius: var(--radius);
  padding: 28px;
  margin: 24px 0;
  border-left: 4px solid var(--yellow);
}

.dialogue-line {
  display: flex;
  gap: 12px;
  margin-bottom: 16px;
  align-items: flex-start;
}

.dialogue-line:last-child { margin-bottom: 0; }

.dialogue-speaker {
  font-weight: 700;
  font-size: 0.8rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: var(--blue);
  min-width: 60px;
  padding-top: 2px;
}

.dialogue-text {
  font-size: 1rem;
  line-height: 1.5;
}

.dialogue-text .swedish-line {
  font-weight: 600;
  display: block;
}

.dialogue-text .english-line {
  font-size: 0.85rem;
  color: var(--text-light);
  font-style: italic;
}

/* ‚îÄ‚îÄ‚îÄ GRAMMAR BOX ‚îÄ‚îÄ‚îÄ */
.grammar-box {
  background: var(--forest-light);
  border-radius: var(--radius);
  padding: 28px;
  margin: 24px 0;
}

.grammar-box h4 {
  color: var(--forest);
  font-size: 1rem;
  margin-bottom: 12px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.grammar-box .rule {
  font-size: 0.95rem;
  line-height: 1.6;
  margin-bottom: 8px;
}

.grammar-box .example {
  background: white;
  padding: 12px 16px;
  border-radius: 8px;
  margin-top: 12px;
  font-family: 'JetBrains Mono', monospace;
  font-size: 0.88rem;
}

.grammar-box .example .highlight {
  color: var(--forest);
  font-weight: 700;
}

/* ‚îÄ‚îÄ‚îÄ TIP BOX ‚îÄ‚îÄ‚îÄ */
.tip-box {
  background: var(--yellow-light);
  border-radius: var(--radius);
  padding: 20px 24px;
  margin: 20px 0;
  display: flex;
  gap: 12px;
  align-items: flex-start;
}

.tip-box .tip-icon { font-size: 1.3rem; flex-shrink: 0; }
.tip-box p { font-size: 0.9rem; line-height: 1.5; }

/* ‚îÄ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ‚îÄ */
.btn {
  padding: 12px 28px;
  border-radius: 8px;
  font-family: 'Outfit', sans-serif;
  font-size: 0.95rem;
  font-weight: 600;
  cursor: pointer;
  border: none;
  transition: all 0.2s;
}

.btn-primary {
  background: var(--blue);
  color: white;
}
.btn-primary:hover { background: var(--blue-dark); }

.btn-secondary {
  background: white;
  color: var(--text);
  border: 2px solid var(--warm-dark);
}
.btn-secondary:hover { border-color: var(--blue); }

.btn-yellow {
  background: var(--yellow);
  color: var(--text);
}
.btn-yellow:hover { background: var(--yellow-dark); }

.btn-group {
  display: flex;
  gap: 12px;
  margin-top: 24px;
}

/* ‚îÄ‚îÄ‚îÄ PROGRESS BAR ‚îÄ‚îÄ‚îÄ */
.progress-bar {
  width: 100%;
  height: 8px;
  background: var(--warm-dark);
  border-radius: 4px;
  overflow: hidden;
  margin: 16px 0;
}

.progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--blue), var(--forest));
  border-radius: 4px;
  transition: width 0.5s ease;
}

/* ‚îÄ‚îÄ‚îÄ MATCHING EXERCISE ‚îÄ‚îÄ‚îÄ */
.match-container {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.match-column h4 {
  font-size: 0.85rem;
  text-transform: uppercase;
  letter-spacing: 0.04em;
  color: var(--text-light);
  margin-bottom: 12px;
}

.match-item {
  padding: 14px 18px;
  background: white;
  border: 2px solid var(--warm-dark);
  border-radius: 8px;
  cursor: pointer;
  transition: all 0.15s;
  margin-bottom: 8px;
  font-size: 0.95rem;
}

.match-item:hover { border-color: var(--blue); }
.match-item.selected { border-color: var(--blue); background: var(--blue-light); }
.match-item.matched { border-color: var(--correct); background: var(--correct-bg); opacity: 0.7; cursor: default; }

/* ‚îÄ‚îÄ‚îÄ FLASHCARD ‚îÄ‚îÄ‚îÄ */
.flashcard-container { perspective: 1000px; margin: 24px auto; max-width: 400px; }

.flashcard {
  width: 100%;
  height: 240px;
  cursor: pointer;
  position: relative;
  transform-style: preserve-3d;
  transition: transform 0.6s;
}

.flashcard.flipped { transform: rotateY(180deg); }

.flashcard-front, .flashcard-back {
  position: absolute;
  width: 100%; height: 100%;
  backface-visibility: hidden;
  border-radius: var(--radius);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 32px;
  box-shadow: var(--shadow-lg);
}

.flashcard-front {
  background: linear-gradient(135deg, var(--blue), var(--blue-dark));
  color: white;
}

.flashcard-back {
  background: white;
  transform: rotateY(180deg);
  border: 2px solid var(--yellow);
}

.flashcard-front .word {
  font-family: 'DM Serif Display', serif;
  font-size: 2rem;
}

.flashcard-front .hint {
  font-size: 0.85rem;
  opacity: 0.7;
  margin-top: 12px;
}

.flashcard-back .translation {
  font-size: 1.5rem;
  font-weight: 600;
  color: var(--blue-dark);
}

.flashcard-back .extra {
  font-size: 0.9rem;
  color: var(--text-light);
  margin-top: 8px;
}

.flashcard-controls {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-top: 20px;
}

.flashcard-counter {
  text-align: center;
  font-size: 0.85rem;
  color: var(--text-light);
  margin-bottom: 12px;
}

/* ‚îÄ‚îÄ‚îÄ QUIZ RESULTS ‚îÄ‚îÄ‚îÄ */
.quiz-results {
  text-align: center;
  padding: 40px;
}

.quiz-results .score-circle {
  width: 140px; height: 140px;
  border-radius: 50%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  margin: 0 auto 24px;
  font-size: 2.5rem;
  font-weight: 700;
}

.quiz-results .score-circle.great { background: var(--correct-bg); color: var(--correct); }
.quiz-results .score-circle.ok { background: var(--yellow-light); color: var(--yellow-dark); }
.quiz-results .score-circle.needs-work { background: var(--wrong-bg); color: var(--wrong); }

.quiz-results .score-label { font-size: 0.8rem; font-weight: 500; }
.quiz-results h3 { font-size: 1.4rem; margin-bottom: 8px; }
.quiz-results p { color: var(--text-light); margin-bottom: 24px; }

/* ‚îÄ‚îÄ‚îÄ SENTENCE BUILDER ‚îÄ‚îÄ‚îÄ */
.sentence-builder {
  margin: 20px 0;
}

.word-bank {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  padding: 20px;
  background: var(--warm);
  border-radius: 8px;
  min-height: 60px;
  margin-bottom: 12px;
}

.word-chip {
  padding: 8px 16px;
  background: white;
  border: 2px solid var(--warm-dark);
  border-radius: 20px;
  cursor: pointer;
  font-size: 0.95rem;
  font-weight: 500;
  transition: all 0.15s;
  user-select: none;
}

.word-chip:hover { border-color: var(--blue); background: var(--blue-light); }
.word-chip.used { opacity: 0.3; cursor: default; }

.sentence-area {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  padding: 20px;
  background: white;
  border: 2px dashed var(--warm-dark);
  border-radius: 8px;
  min-height: 60px;
}

.sentence-area .word-chip {
  border-color: var(--blue);
  background: var(--blue-light);
}

/* ‚îÄ‚îÄ‚îÄ FOOTER ‚îÄ‚îÄ‚îÄ */
.footer {
  background: var(--blue-dark);
  color: rgba(255,255,255,0.7);
  text-align: center;
  padding: 32px;
  font-size: 0.85rem;
}

.footer a { color: var(--yellow); text-decoration: none; }
.footer a:hover { text-decoration: underline; }

/* ‚îÄ‚îÄ‚îÄ RESPONSIVE ‚îÄ‚îÄ‚îÄ */
@media (max-width: 768px) {
  .header-top { padding: 12px 16px; }
  .nav { padding: 0 16px; overflow-x: auto; }
  .nav-tab { padding: 10px 16px; white-space: nowrap; font-size: 0.82rem; }
  .hero { padding: 48px 16px; }
  .hero h2 { font-size: 2rem; }
  .hero-levels { gap: 10px; }
  .level-card { min-width: 140px; padding: 18px; }
  .main { padding: 24px 16px 60px; }
  .lesson-container { grid-template-columns: 1fr; }
  .lesson-sidebar { position: static; }
  .lesson-content { padding: 24px; }
  .options-grid { grid-template-columns: 1fr; }
  .match-container { grid-template-columns: 1fr; }
  .header-stats { display: none; }
}

/* ‚îÄ‚îÄ‚îÄ ANIMATIONS ‚îÄ‚îÄ‚îÄ */
.fade-in {
  animation: fadeIn 0.4s ease;
}

.slide-up {
  animation: slideUp 0.4s ease;
}

@keyframes slideUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.hidden { display: none !important; }
</style>
</head>
<body>

<header class="header">
  <div class="header-top">
    <div class="logo" onclick="showHome()">
      <div class="logo-flag"></div>
      <h1>L√§r dig <span>Svenska</span></h1>
    </div>
    <div class="header-stats">
      <div class="stat-badge">
        <span class="icon">üî•</span>
        <span id="streak">0 streak</span>
      </div>
      <div class="stat-badge">
        <span class="icon">‚≠ê</span>
        <span id="xp">0 XP</span>
      </div>
    </div>
  </div>
  <nav class="nav">
    <button class="nav-tab active" onclick="showHome()" data-tab="home">Hem (Home)</button>
    <button class="nav-tab" onclick="showLevel('A')" data-tab="A">Kurs A</button>
    <button class="nav-tab" onclick="showLevel('B')" data-tab="B">Kurs B</button>
    <button class="nav-tab" onclick="showLevel('C')" data-tab="C">Kurs C</button>
    <button class="nav-tab" onclick="showLevel('D')" data-tab="D">Kurs D</button>
    <button class="nav-tab" onclick="showPhrases()" data-tab="phrases">Vardagsfraser</button>
  </nav>
</header>

<div id="app"></div>

<footer class="footer">
  <p>L√§r dig Svenska ‚Äî A free SFI learning resource. Built with ‚ù§Ô∏è for Swedish learners everywhere.</p>
  <p style="margin-top: 8px;">This is a free educational tool ‚Äî not affiliated with any SFI program.</p>
</footer>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// APP STATE
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const state = {
  xp: 0,
  streak: 0,
  completed: {},
  currentView: 'home'
};

function addXP(n) {
  state.xp += n;
  document.getElementById('xp').textContent = state.xp + ' XP';
}

function addStreak() {
  state.streak++;
  document.getElementById('streak').textContent = state.streak + ' streak';
}

function setActiveTab(tab) {
  document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll(`.nav-tab[data-tab="${tab}"]`).forEach(t => t.classList.add('active'));
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// COURSE DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const courseData = {
  A: {
    name: "Kurs A ‚Äî Nyb√∂rjare (Absolute Beginner)",
    desc: "Start from zero. Learn the Swedish alphabet, basic greetings, numbers, and everyday words.",
    topics: [
      {
        id: "a1", icon: "üëã", title: "H√§lsningar (Greetings)",
        desc: "Say hello, goodbye, and introduce yourself.",
        tags: ["Speaking", "12 words"],
        vocab: [
          { sv: "Hej", en: "Hello/Hi", pron: "hey" },
          { sv: "God morgon", en: "Good morning", pron: "goo-mor-on" },
          { sv: "God kv√§ll", en: "Good evening", pron: "goo-kvell" },
          { sv: "Hej d√•", en: "Goodbye", pron: "hey-doh" },
          { sv: "Tack", en: "Thank you", pron: "tahk" },
          { sv: "Tack s√• mycket", en: "Thank you very much", pron: "tahk soh mee-keh" },
          { sv: "Ja", en: "Yes", pron: "yah" },
          { sv: "Nej", en: "No", pron: "ney" },
          { sv: "Urs√§kta", en: "Excuse me", pron: "ur-shek-ta" },
          { sv: "F√∂rl√•t", en: "Sorry", pron: "fur-loht" },
          { sv: "Sn√§lla", en: "Please", pron: "snel-la" },
          { sv: "Vars√•god", en: "You're welcome", pron: "var-sho-good" }
        ],
        dialogue: [
          { speaker: "Anna", sv: "Hej! Jag heter Anna.", en: "Hi! My name is Anna." },
          { speaker: "Erik", sv: "Hej Anna! Jag heter Erik. Hur m√•r du?", en: "Hi Anna! My name is Erik. How are you?" },
          { speaker: "Anna", sv: "Jag m√•r bra, tack! Och du?", en: "I'm fine, thanks! And you?" },
          { speaker: "Erik", sv: "Jag m√•r bra. Trevligt att tr√§ffas!", en: "I'm fine. Nice to meet you!" },
          { speaker: "Anna", sv: "Trevligt att tr√§ffas! Hej d√•!", en: "Nice to meet you! Goodbye!" }
        ],
        grammar: {
          title: "Introducing Yourself",
          rule: "Use \"Jag heter...\" (I am called...) to say your name. \"Hur m√•r du?\" means \"How are you?\" ‚Äî answer with \"Jag m√•r bra\" (I am fine).",
          example: "Jag heter [your name]. Hur m√•r du? ‚Äî Jag m√•r bra, tack!"
        },
        exercises: [
          { type: "mc", q: "How do you say 'Hello' in Swedish?", options: ["Hej", "Nej", "Tack", "Hej d√•"], answer: 0 },
          { type: "mc", q: "What does 'Tack' mean?", options: ["Hello", "Goodbye", "Thank you", "Sorry"], answer: 2 },
          { type: "mc", q: "How do you say 'My name is...'?", options: ["Jag m√•r...", "Jag heter...", "Jag bor...", "Jag har..."], answer: 1 },
          { type: "fill", q: "Hej! ___ heter Maria.", answer: "Jag", hint: "I" },
          { type: "fill", q: "Hur ___ du?", answer: "m√•r", hint: "How are you?" },
          { type: "mc", q: "What does 'Hej d√•' mean?", options: ["Hello", "Thank you", "Goodbye", "Please"], answer: 2 },
        ]
      },
      {
        id: "a2", icon: "üî¢", title: "Siffror (Numbers 1-20)",
        desc: "Count in Swedish from 1 to 20.",
        tags: ["Numbers", "20 words"],
        vocab: [
          { sv: "ett", en: "one (1)", pron: "eht" },
          { sv: "tv√•", en: "two (2)", pron: "tvoh" },
          { sv: "tre", en: "three (3)", pron: "treh" },
          { sv: "fyra", en: "four (4)", pron: "fee-ra" },
          { sv: "fem", en: "five (5)", pron: "fem" },
          { sv: "sex", en: "six (6)", pron: "sex" },
          { sv: "sju", en: "seven (7)", pron: "hwoo" },
          { sv: "√•tta", en: "eight (8)", pron: "oh-ta" },
          { sv: "nio", en: "nine (9)", pron: "nee-oh" },
          { sv: "tio", en: "ten (10)", pron: "tee-oh" },
          { sv: "elva", en: "eleven (11)", pron: "el-va" },
          { sv: "tolv", en: "twelve (12)", pron: "tolv" },
          { sv: "tretton", en: "thirteen (13)", pron: "tret-on" },
          { sv: "fjorton", en: "fourteen (14)", pron: "fyor-ton" },
          { sv: "femton", en: "fifteen (15)", pron: "fem-ton" },
          { sv: "sexton", en: "sixteen (16)", pron: "sex-ton" },
          { sv: "sjutton", en: "seventeen (17)", pron: "hwoo-ton" },
          { sv: "arton", en: "eighteen (18)", pron: "ar-ton" },
          { sv: "nitton", en: "nineteen (19)", pron: "nit-on" },
          { sv: "tjugo", en: "twenty (20)", pron: "hoo-go" }
        ],
        grammar: {
          title: "Swedish Numbers Pattern",
          rule: "Numbers 13-19 follow a pattern: the digit + 'ton' (like English '-teen'). For example: tre + ton = tretton (13), fem + ton = femton (15).",
          example: "tre ‚Üí tretton (13), fyra ‚Üí fjorton (14), fem ‚Üí femton (15)"
        },
        exercises: [
          { type: "mc", q: "What is 'tre' in English?", options: ["Two", "Three", "Four", "Five"], answer: 1 },
          { type: "mc", q: "How do you say '7' in Swedish?", options: ["sex", "sju", "√•tta", "nio"], answer: 1 },
          { type: "fill", q: "fem + ton = ___", answer: "femton", hint: "fifteen" },
          { type: "mc", q: "What number is 'tolv'?", options: ["10", "11", "12", "13"], answer: 2 },
          { type: "fill", q: "The Swedish word for 20 is ___.", answer: "tjugo", hint: "twenty" },
          { type: "mc", q: "What is 'nio' in English?", options: ["Six", "Seven", "Eight", "Nine"], answer: 3 },
        ]
      },
      {
        id: "a3", icon: "üë®‚Äçüë©‚Äçüëß", title: "Familj (Family)",
        desc: "Learn words for family members.",
        tags: ["Vocabulary", "14 words"],
        vocab: [
          { sv: "mamma", en: "mom", pron: "mam-ma" },
          { sv: "pappa", en: "dad", pron: "pap-pa" },
          { sv: "bror", en: "brother", pron: "broor" },
          { sv: "syster", en: "sister", pron: "sys-ter" },
          { sv: "son", en: "son", pron: "sohn" },
          { sv: "dotter", en: "daughter", pron: "dot-ter" },
          { sv: "barn", en: "child/children", pron: "barn" },
          { sv: "fru", en: "wife", pron: "froo" },
          { sv: "man", en: "husband", pron: "man" },
          { sv: "mormor", en: "grandmother (maternal)", pron: "moor-moor" },
          { sv: "morfar", en: "grandfather (maternal)", pron: "moor-far" },
          { sv: "farmor", en: "grandmother (paternal)", pron: "far-moor" },
          { sv: "farfar", en: "grandfather (paternal)", pron: "far-far" },
          { sv: "familj", en: "family", pron: "fa-milj" }
        ],
        grammar: {
          title: "Swedish Grandparent Names",
          rule: "Swedish is specific about grandparents! 'mor' = mother, 'far' = father. Combine them: mormor = mother's mother, morfar = mother's father, farmor = father's mother, farfar = father's father.",
          example: "mormor = mor + mor (mother's mother) = maternal grandmother"
        },
        exercises: [
          { type: "mc", q: "What does 'bror' mean?", options: ["Sister", "Brother", "Son", "Father"], answer: 1 },
          { type: "mc", q: "What is 'mormor'?", options: ["Aunt", "Paternal grandmother", "Maternal grandmother", "Mother"], answer: 2 },
          { type: "fill", q: "My father's father is my ___.", answer: "farfar", hint: "far + far" },
          { type: "mc", q: "What does 'barn' mean?", options: ["Baby", "Child/Children", "Brother", "Born"], answer: 1 },
          { type: "fill", q: "The Swedish word for 'daughter' is ___.", answer: "dotter", hint: "" },
          { type: "mc", q: "'Familj' means...?", options: ["Familiar", "Family", "Famous", "Farm"], answer: 1 },
        ]
      },
      {
        id: "a4", icon: "üé®", title: "F√§rger (Colors)",
        desc: "Learn basic colors in Swedish.",
        tags: ["Vocabulary", "10 words"],
        vocab: [
          { sv: "r√∂d", en: "red", pron: "ruhd" },
          { sv: "bl√•", en: "blue", pron: "bloh" },
          { sv: "gr√∂n", en: "green", pron: "gruhn" },
          { sv: "gul", en: "yellow", pron: "gool" },
          { sv: "vit", en: "white", pron: "veet" },
          { sv: "svart", en: "black", pron: "svart" },
          { sv: "brun", en: "brown", pron: "broon" },
          { sv: "rosa", en: "pink", pron: "roh-sa" },
          { sv: "orange", en: "orange", pron: "oh-ransh" },
          { sv: "lila", en: "purple", pron: "lee-la" }
        ],
        grammar: {
          title: "Colors as Adjectives",
          rule: "In Swedish, colors change form depending on the noun's gender. With 'en' words, use the base form (r√∂d). With 'ett' words, add -t (r√∂tt). With plural, add -a (r√∂da).",
          example: "en r√∂d bil (a red car) | ett r√∂tt hus (a red house) | r√∂da bilar (red cars)"
        },
        exercises: [
          { type: "mc", q: "What color is 'bl√•'?", options: ["Red", "Blue", "Green", "Black"], answer: 1 },
          { type: "mc", q: "How do you say 'yellow' in Swedish?", options: ["gr√∂n", "gul", "vit", "brun"], answer: 1 },
          { type: "fill", q: "The Swedish word for 'black' is ___.", answer: "svart", hint: "" },
          { type: "mc", q: "What does 'gr√∂n' mean?", options: ["Gray", "Green", "Gold", "Brown"], answer: 1 },
          { type: "fill", q: "A red car in Swedish: en ___ bil.", answer: "r√∂d", hint: "red" },
          { type: "mc", q: "'Lila' means...?", options: ["Lilac/Purple", "Lime", "Light", "Little"], answer: 0 },
        ]
      }
    ]
  },
  B: {
    name: "Kurs B ‚Äî Grundl√§ggande (Elementary)",
    desc: "Build basic sentences, talk about daily routines, food, and weather.",
    topics: [
      {
        id: "b1", icon: "üçΩÔ∏è", title: "Mat och Dryck (Food & Drink)",
        desc: "Order food, discuss meals, and learn grocery vocabulary.",
        tags: ["Practical", "15 words"],
        vocab: [
          { sv: "br√∂d", en: "bread", pron: "bruhd" },
          { sv: "sm√∂r", en: "butter", pron: "smuhr" },
          { sv: "mj√∂lk", en: "milk", pron: "myulk" },
          { sv: "kaffe", en: "coffee", pron: "kaf-feh" },
          { sv: "vatten", en: "water", pron: "vat-en" },
          { sv: "k√∂tt", en: "meat", pron: "shut" },
          { sv: "fisk", en: "fish", pron: "fisk" },
          { sv: "gr√∂nsaker", en: "vegetables", pron: "gruhn-sah-ker" },
          { sv: "frukt", en: "fruit", pron: "frukt" },
          { sv: "ris", en: "rice", pron: "rees" },
          { sv: "√§gg", en: "egg", pron: "ehg" },
          { sv: "ost", en: "cheese", pron: "oost" },
          { sv: "soppa", en: "soup", pron: "sop-pa" },
          { sv: "sallad", en: "salad", pron: "sal-lad" },
          { sv: "glass", en: "ice cream", pron: "glass" }
        ],
        dialogue: [
          { speaker: "Kass√∂r", sv: "Hej! Vad vill du ha?", en: "Hi! What would you like?" },
          { speaker: "Du", sv: "Jag vill ha en kaffe och ett br√∂d, tack.", en: "I would like a coffee and a bread, please." },
          { speaker: "Kass√∂r", sv: "Vill du ha mj√∂lk i kaffet?", en: "Would you like milk in the coffee?" },
          { speaker: "Du", sv: "Ja, tack. Och lite sm√∂r till br√∂det.", en: "Yes, please. And some butter for the bread." },
          { speaker: "Kass√∂r", sv: "Det blir fyrtio kronor.", en: "That'll be forty kronor." }
        ],
        grammar: {
          title: "Ordering with 'Jag vill ha'",
          rule: "'Jag vill ha' means 'I would like' ‚Äî use it when ordering food or requesting things. Add 'tack' (please) to be polite.",
          example: "Jag vill ha <span class='highlight'>en</span> soppa, tack. (I'd like a soup, please.)"
        },
        exercises: [
          { type: "mc", q: "What does 'mj√∂lk' mean?", options: ["Milk", "Meat", "Meal", "More"], answer: 0 },
          { type: "mc", q: "How do you say 'I would like' in Swedish?", options: ["Jag har", "Jag vill ha", "Jag kan", "Jag g√∂r"], answer: 1 },
          { type: "fill", q: "Jag vill ha en ___, tack. (coffee)", answer: "kaffe", hint: "coffee" },
          { type: "mc", q: "What is 'gr√∂nsaker'?", options: ["Groceries", "Grains", "Vegetables", "Green salad"], answer: 2 },
          { type: "fill", q: "The Swedish word for 'bread' is ___.", answer: "br√∂d", hint: "" },
          { type: "mc", q: "'Ost' means...?", options: ["Oats", "Oyster", "Cheese", "East"], answer: 2 },
        ]
      },
      {
        id: "b2", icon: "‚õÖ", title: "V√§der (Weather)",
        desc: "Talk about the weather ‚Äî essential in Sweden!",
        tags: ["Conversation", "12 words"],
        vocab: [
          { sv: "solen", en: "the sun", pron: "soo-len" },
          { sv: "regn", en: "rain", pron: "reyn" },
          { sv: "sn√∂", en: "snow", pron: "snuh" },
          { sv: "vind", en: "wind", pron: "vind" },
          { sv: "kallt", en: "cold", pron: "kalt" },
          { sv: "varmt", en: "warm/hot", pron: "varmt" },
          { sv: "molnigt", en: "cloudy", pron: "moln-igt" },
          { sv: "soligt", en: "sunny", pron: "soo-lit" },
          { sv: "det regnar", en: "it's raining", pron: "deh rey-nar" },
          { sv: "det sn√∂ar", en: "it's snowing", pron: "deh snuh-ar" },
          { sv: "grader", en: "degrees", pron: "grah-der" },
          { sv: "v√•r", en: "spring", pron: "vohr" }
        ],
        grammar: {
          title: "Weather Expressions with 'Det √§r'",
          rule: "Swedish weather expressions usually start with 'Det √§r' (It is) + adjective, or 'Det' + verb. Unlike English, Swedish uses specific weather verbs.",
          example: "Det √§r kallt. (It is cold.) | Det regnar. (It's raining.) | Det √§r soligt idag. (It's sunny today.)"
        },
        exercises: [
          { type: "mc", q: "How do you say 'It's raining' in Swedish?", options: ["Det sn√∂ar", "Det regnar", "Det bl√•ser", "Det √§r kallt"], answer: 1 },
          { type: "fill", q: "Det √§r ___ idag. (cold)", answer: "kallt", hint: "cold" },
          { type: "mc", q: "What does 'sn√∂' mean?", options: ["Sun", "Snow", "Slow", "Shoe"], answer: 1 },
          { type: "mc", q: "'Soligt' means...?", options: ["Solid", "Snowy", "Sunny", "Stormy"], answer: 2 },
          { type: "fill", q: "The Swedish word for 'wind' is ___.", answer: "vind", hint: "" },
          { type: "mc", q: "What season is 'v√•r'?", options: ["Summer", "Autumn", "Winter", "Spring"], answer: 3 },
        ]
      },
      {
        id: "b3", icon: "üïê", title: "Klockan (Telling Time)",
        desc: "Learn to tell and ask about time in Swedish.",
        tags: ["Practical", "10 phrases"],
        vocab: [
          { sv: "Vad √§r klockan?", en: "What time is it?", pron: "vah ehr klok-an" },
          { sv: "Klockan √§r ett", en: "It's one o'clock", pron: "klok-an ehr eht" },
          { sv: "halv", en: "half (past)", pron: "halv" },
          { sv: "kvart √∂ver", en: "quarter past", pron: "kvart uh-ver" },
          { sv: "kvart i", en: "quarter to", pron: "kvart ee" },
          { sv: "p√• morgonen", en: "in the morning", pron: "poh mor-on-en" },
          { sv: "p√• kv√§llen", en: "in the evening", pron: "poh kvel-en" },
          { sv: "idag", en: "today", pron: "ee-dahg" },
          { sv: "ig√•r", en: "yesterday", pron: "ee-gohr" },
          { sv: "imorgon", en: "tomorrow", pron: "ee-mor-on" }
        ],
        grammar: {
          title: "Swedish Time ‚Äî 'Halv' Trick",
          rule: "IMPORTANT: 'Halv' in Swedish refers to the NEXT hour, not the current one! 'Halv tre' means 2:30 (half towards three), NOT 3:30. This catches many learners off guard!",
          example: "halv tre = 2:30 ‚ö†Ô∏è (half toward three, NOT 3:30!)\nkvart √∂ver tv√• = 2:15\nkvart i tre = 2:45"
        },
        exercises: [
          { type: "mc", q: "What time is 'halv tre'?", options: ["3:30", "2:30", "2:00", "3:00"], answer: 1 },
          { type: "mc", q: "How do you ask 'What time is it?'", options: ["Vad tid?", "Hur klockan?", "Vad √§r klockan?", "Vilken tid?"], answer: 2 },
          { type: "fill", q: "Quarter past two = kvart ___ tv√•.", answer: "√∂ver", hint: "past" },
          { type: "mc", q: "'Imorgon' means...?", options: ["This morning", "Tomorrow", "Yesterday", "Today"], answer: 1 },
          { type: "fill", q: "Yesterday in Swedish is ___.", answer: "ig√•r", hint: "" },
          { type: "mc", q: "What time is 'kvart i fem'?", options: ["5:15", "4:15", "4:45", "5:45"], answer: 2 },
        ]
      }
    ]
  },
  C: {
    name: "Kurs C ‚Äî Mellanliggande (Intermediate)",
    desc: "Read and write longer texts, discuss work, housing, and health.",
    topics: [
      {
        id: "c1", icon: "üíº", title: "Arbete (Work & Job Seeking)",
        desc: "Vocabulary for the workplace, writing CVs, and job interviews.",
        tags: ["Professional", "15 words"],
        vocab: [
          { sv: "arbete", en: "work/job", pron: "ar-beh-teh" },
          { sv: "anst√§lld", en: "employed", pron: "an-steld" },
          { sv: "arbetsl√∂s", en: "unemployed", pron: "ar-bets-luhs" },
          { sv: "ans√∂kan", en: "application", pron: "an-suh-kan" },
          { sv: "CV/meritlista", en: "resume/CV", pron: "seh-veh / meh-rit-lis-ta" },
          { sv: "intervju", en: "interview", pron: "in-ter-vyoo" },
          { sv: "l√∂n", en: "salary", pron: "luhn" },
          { sv: "erfarenhet", en: "experience", pron: "er-fah-ren-het" },
          { sv: "utbildning", en: "education", pron: "oot-bild-ning" },
          { sv: "kollega", en: "colleague", pron: "kol-leh-ga" },
          { sv: "chef", en: "boss/manager", pron: "shef" },
          { sv: "schema", en: "schedule", pron: "sheh-ma" },
          { sv: "semester", en: "vacation", pron: "seh-mes-ter" },
          { sv: "heltid", en: "full-time", pron: "hel-teed" },
          { sv: "deltid", en: "part-time", pron: "del-teed" }
        ],
        dialogue: [
          { speaker: "Intervjuare", sv: "Ber√§tta om dig sj√§lv.", en: "Tell us about yourself." },
          { speaker: "Du", sv: "Jag heter... och jag har erfarenhet inom...", en: "My name is... and I have experience in..." },
          { speaker: "Intervjuare", sv: "Vilken utbildning har du?", en: "What education do you have?" },
          { speaker: "Du", sv: "Jag har studerat... i mitt hemland.", en: "I studied... in my home country." },
          { speaker: "Intervjuare", sv: "Kan du jobba heltid?", en: "Can you work full-time?" },
          { speaker: "Du", sv: "Ja, jag kan b√∂rja direkt.", en: "Yes, I can start immediately." }
        ],
        grammar: {
          title: "Talking About Your Experience",
          rule: "Use 'Jag har + noun' for possessions/experience. 'Jag har jobbat som...' (I have worked as...) uses the perfect tense with 'har' + past participle.",
          example: "Jag <span class='highlight'>har jobbat</span> som l√§rare i tre √•r. (I have worked as a teacher for three years.)"
        },
        exercises: [
          { type: "mc", q: "What does 'arbetsl√∂s' mean?", options: ["Hardworking", "Employed", "Unemployed", "Worker"], answer: 2 },
          { type: "fill", q: "Jag har ___ som kock. (worked)", answer: "jobbat", hint: "past participle of jobba" },
          { type: "mc", q: "'L√∂n' means...?", options: ["Loan", "Long", "Salary", "Lunch"], answer: 2 },
          { type: "mc", q: "What is 'deltid'?", options: ["Full-time", "Part-time", "Deadline", "Detail"], answer: 1 },
          { type: "fill", q: "A job interview in Swedish is an ___.", answer: "intervju", hint: "" },
          { type: "mc", q: "'Semester' in Swedish means...?", options: ["School term", "Semester", "Vacation", "Summer"], answer: 2 },
        ]
      },
      {
        id: "c2", icon: "üè•", title: "H√§lsa (Health)",
        desc: "Visit the doctor, describe symptoms, and understand health care.",
        tags: ["Essential", "14 words"],
        vocab: [
          { sv: "sjuk", en: "sick", pron: "hwook" },
          { sv: "frisk", en: "healthy", pron: "frisk" },
          { sv: "l√§kare", en: "doctor", pron: "leh-ka-reh" },
          { sv: "sjukhus", en: "hospital", pron: "hwook-hoos" },
          { sv: "v√•rdcentral", en: "health clinic", pron: "vord-sen-trahl" },
          { sv: "recept", en: "prescription", pron: "reh-sept" },
          { sv: "medicin", en: "medicine", pron: "meh-di-seen" },
          { sv: "ont", en: "pain/ache", pron: "ohnt" },
          { sv: "feber", en: "fever", pron: "feh-ber" },
          { sv: "hosta", en: "cough", pron: "hoos-ta" },
          { sv: "huvudv√§rk", en: "headache", pron: "hoo-vud-verk" },
          { sv: "allergisk", en: "allergic", pron: "al-ler-gisk" },
          { sv: "boka tid", en: "book an appointment", pron: "boo-ka teed" },
          { sv: "apotek", en: "pharmacy", pron: "a-poo-tek" }
        ],
        grammar: {
          title: "Describing Pain with 'Ont i'",
          rule: "'Jag har ont i...' means 'I have pain in...'. This is the standard way to describe where something hurts.",
          example: "Jag har <span class='highlight'>ont i</span> huvudet. (I have a headache.)\nJag har <span class='highlight'>ont i</span> magen. (I have a stomach ache.)"
        },
        exercises: [
          { type: "mc", q: "Where would you go for a regular check-up?", options: ["Sjukhus", "Apotek", "V√•rdcentral", "Skola"], answer: 2 },
          { type: "fill", q: "Jag har ___ i huvudet. (pain)", answer: "ont", hint: "ache" },
          { type: "mc", q: "What does 'recept' mean?", options: ["Recipe", "Receipt", "Prescription", "Receptionist"], answer: 2 },
          { type: "mc", q: "'Frisk' means...?", options: ["Fresh", "Frozen", "Free", "Healthy"], answer: 3 },
          { type: "fill", q: "I need to ___ tid. (book an appointment)", answer: "boka", hint: "book" },
          { type: "mc", q: "What is 'huvudv√§rk'?", options: ["Heart attack", "Headache", "Heartburn", "Heavy"], answer: 1 },
        ]
      },
      {
        id: "c3", icon: "üè†", title: "Bostad (Housing)",
        desc: "Find an apartment, understand rental contracts, and talk to landlords.",
        tags: ["Practical", "14 words"],
        vocab: [
          { sv: "l√§genhet", en: "apartment", pron: "leh-gen-het" },
          { sv: "hyra", en: "rent", pron: "hee-ra" },
          { sv: "hyresv√§rd", en: "landlord", pron: "hee-res-verd" },
          { sv: "kontrakt", en: "contract", pron: "kon-trakt" },
          { sv: "rum", en: "room", pron: "rum" },
          { sv: "k√∂k", en: "kitchen", pron: "shuhk" },
          { sv: "badrum", en: "bathroom", pron: "bahd-rum" },
          { sv: "sovrum", en: "bedroom", pron: "sohv-rum" },
          { sv: "vardagsrum", en: "living room", pron: "var-dahgs-rum" },
          { sv: "m√∂blerad", en: "furnished", pron: "mub-leh-rad" },
          { sv: "om√∂blerad", en: "unfurnished", pron: "oh-mub-leh-rad" },
          { sv: "inflyttning", en: "move-in", pron: "in-flytt-ning" },
          { sv: "tv√§ttstuga", en: "laundry room", pron: "tvet-stoo-ga" },
          { sv: "v√•ning", en: "floor/story", pron: "voh-ning" }
        ],
        grammar: {
          title: "Compound Words in Swedish",
          rule: "Swedish loves compound words! For housing: sov (sleep) + rum (room) = sovrum (bedroom), vardags (everyday) + rum (room) = vardagsrum (living room). Break long words into parts to understand them.",
          example: "tv√§ttstuga = tv√§tt (laundry) + stuga (cottage/room)\nhyresv√§rd = hyres (rental) + v√§rd (host)"
        },
        exercises: [
          { type: "mc", q: "What does 'l√§genhet' mean?", options: ["Apartment", "House", "Garden", "Garage"], answer: 0 },
          { type: "fill", q: "The kitchen in Swedish is ___.", answer: "k√∂k", hint: "" },
          { type: "mc", q: "'Hyra' means...?", options: ["Hire", "Higher", "Rent", "Here"], answer: 2 },
          { type: "mc", q: "What is a 'tv√§ttstuga'?", options: ["TV room", "Laundry room", "Study", "Attic"], answer: 1 },
          { type: "fill", q: "A furnished apartment is ___.", answer: "m√∂blerad", hint: "" },
          { type: "mc", q: "'Sovrum' translates to...?", options: ["Sunroom", "Showroom", "Bedroom", "Bathroom"], answer: 2 },
        ]
      }
    ]
  },
  D: {
    name: "Kurs D ‚Äî Avancerad (Advanced)",
    desc: "Discuss news, society, opinions, and prepare for further studies.",
    topics: [
      {
        id: "d1", icon: "üì∞", title: "Samh√§lle & Nyheter (Society & News)",
        desc: "Discuss politics, society, and current events in Swedish.",
        tags: ["Advanced", "15 words"],
        vocab: [
          { sv: "samh√§lle", en: "society", pron: "sam-hel-eh" },
          { sv: "regering", en: "government", pron: "reh-yeh-ring" },
          { sv: "riksdag", en: "parliament", pron: "riks-dahg" },
          { sv: "demokrati", en: "democracy", pron: "deh-mo-kra-tee" },
          { sv: "val", en: "election", pron: "vahl" },
          { sv: "r√§ttighet", en: "right (legal)", pron: "ret-ig-het" },
          { sv: "skyldighet", en: "duty/obligation", pron: "shyl-dig-het" },
          { sv: "lag", en: "law", pron: "lahg" },
          { sv: "skatt", en: "tax", pron: "skat" },
          { sv: "j√§mst√§lldhet", en: "gender equality", pron: "yem-steld-het" },
          { sv: "milj√∂", en: "environment", pron: "mil-yuh" },
          { sv: "invandring", en: "immigration", pron: "in-vand-ring" },
          { sv: "nyheter", en: "news", pron: "nee-heh-ter" },
          { sv: "√•sikt", en: "opinion", pron: "oh-sikt" },
          { sv: "debatt", en: "debate", pron: "deh-bat" }
        ],
        grammar: {
          title: "Expressing Opinions",
          rule: "Use these structures to share opinions: 'Jag tycker att...' (I think that...), 'Enligt mig...' (According to me...), 'Jag h√•ller med' (I agree), 'Jag h√•ller inte med' (I disagree).",
          example: "Jag <span class='highlight'>tycker att</span> j√§mst√§lldhet √§r viktigt.\n(I think that gender equality is important.)"
        },
        exercises: [
          { type: "mc", q: "What does 'riksdag' mean?", options: ["King's day", "Parliament", "District", "Kingdom"], answer: 1 },
          { type: "fill", q: "Jag ___ att det √§r en bra id√©. (think)", answer: "tycker", hint: "think/believe" },
          { type: "mc", q: "'J√§mst√§lldhet' means...?", options: ["Justice", "Gender equality", "Jam making", "Jointly"], answer: 1 },
          { type: "mc", q: "What is 'skatt'?", options: ["Skate", "Tax", "Treasure", "Shadow"], answer: 1 },
          { type: "fill", q: "Swedish 'news' is ___.", answer: "nyheter", hint: "" },
          { type: "mc", q: "How do you say 'I agree' in Swedish?", options: ["Jag tycker", "Jag h√•ller med", "Jag vill", "Jag tror"], answer: 1 },
        ]
      },
      {
        id: "d2", icon: "‚úçÔ∏è", title: "Skriftlig Produktion (Writing Skills)",
        desc: "Write formal letters, argumentative texts, and summaries.",
        tags: ["Writing", "12 phrases"],
        vocab: [
          { sv: "B√§sta...", en: "Dear... (formal)", pron: "bes-ta" },
          { sv: "Med v√§nliga h√§lsningar", en: "Kind regards", pron: "med ven-li-ga hels-ningar" },
          { sv: "Jag skriver till er ang√•ende...", en: "I am writing to you regarding...", pron: "" },
          { sv: "√Ö ena sidan... √• andra sidan", en: "On one hand... on the other hand", pron: "" },
          { sv: "Dessutom", en: "Furthermore", pron: "des-oo-tom" },
          { sv: "Sammanfattningsvis", en: "In summary", pron: "sam-man-fat-nings-vees" },
          { sv: "Enligt min √•sikt", en: "In my opinion", pron: "" },
          { sv: "Till att b√∂rja med", en: "To begin with", pron: "" },
          { sv: "Avslutningsvis", en: "In conclusion", pron: "av-sloot-nings-vees" },
          { sv: "Det beror p√•", en: "It depends on", pron: "deh beh-roor poh" },
          { sv: "till exempel", en: "for example", pron: "til ek-sem-pel" },
          { sv: "det vill s√§ga", en: "that is to say", pron: "deh vil seh-ya" }
        ],
        grammar: {
          title: "Formal Letter Structure",
          rule: "Swedish formal letters follow this structure: 1) B√§sta + title/name, 2) State purpose: 'Jag skriver ang√•ende...', 3) Body paragraphs with linking words, 4) Close: 'Med v√§nliga h√§lsningar' + your name.",
          example: "B√§sta Handl√§ggare,\nJag skriver till er <span class='highlight'>ang√•ende</span> min ans√∂kan..."
        },
        exercises: [
          { type: "mc", q: "How do you start a formal letter in Swedish?", options: ["Hej!", "K√§ra...", "B√§sta...", "Till..."], answer: 2 },
          { type: "fill", q: "In conclusion = ___", answer: "Avslutningsvis", hint: "" },
          { type: "mc", q: "'Dessutom' means...?", options: ["Despite", "Furthermore", "Instead", "However"], answer: 1 },
          { type: "mc", q: "How do you end a formal letter?", options: ["Hej d√•", "Kram", "Med v√§nliga h√§lsningar", "Puss och kram"], answer: 2 },
          { type: "fill", q: "___ min √•sikt (In my opinion)", answer: "Enligt", hint: "According to" },
          { type: "mc", q: "'Till exempel' means...?", options: ["Excellent", "For example", "To examine", "Too extreme"], answer: 1 },
        ]
      },
      {
        id: "d3", icon: "üìñ", title: "L√§sf√∂rst√•else (Reading Comprehension)",
        desc: "Practice understanding longer Swedish texts and articles.",
        tags: ["Reading", "Advanced"],
        vocab: [
          { sv: "f√∂rfattare", en: "author", pron: "fur-fat-ah-reh" },
          { sv: "stycke", en: "paragraph", pron: "styk-eh" },
          { sv: "betydelse", en: "meaning", pron: "beh-tee-del-seh" },
          { sv: "synonym", en: "synonym", pron: "see-noh-neem" },
          { sv: "sammanhang", en: "context", pron: "sam-man-hang" },
          { sv: "k√§lla", en: "source", pron: "shel-la" },
          { sv: "tolka", en: "interpret", pron: "tol-ka" },
          { sv: "j√§mf√∂ra", en: "compare", pron: "yem-fuh-ra" },
          { sv: "analysera", en: "analyze", pron: "a-na-lee-seh-ra" },
          { sv: "argumentera", en: "argue/make a case", pron: "ar-gu-men-teh-ra" }
        ],
        grammar: {
          title: "Reading Strategy: Breaking Down Compound Words",
          rule: "Swedish has very long compound words. Break them apart: 'sjukv√•rdsr√•dgivning' = sjuk (sick) + v√•rd (care) + r√•d (advice) + givning (giving) = healthcare advice. Look for familiar parts!",
          example: "arbets¬∑mark¬∑nads¬∑departementet =\narbets (work) + marknads (market) + departementet (the department)\n= The Labor Market Department"
        },
        exercises: [
          { type: "mc", q: "What does 'f√∂rfattare' mean?", options: ["Factory", "Father", "Author", "Fortunate"], answer: 2 },
          { type: "fill", q: "To compare in Swedish is ___.", answer: "j√§mf√∂ra", hint: "" },
          { type: "mc", q: "'Sammanhang' means...?", options: ["Hanging together", "Summary", "Context", "Conversation"], answer: 2 },
          { type: "mc", q: "'Tolka' means...?", options: ["Talk", "Interpret", "Tolerate", "Touch"], answer: 1 },
          { type: "fill", q: "The Swedish word for 'meaning' is ___.", answer: "betydelse", hint: "" },
          { type: "mc", q: "'K√§lla' means...?", options: ["Cellar", "Source", "Cold", "Call"], answer: 1 },
        ]
      }
    ]
  }
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// EVERYDAY PHRASES DATA
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const phrasesData = {
  categories: [
    {
      icon: "üè™", title: "I aff√§ren (At the store)",
      phrases: [
        { sv: "Vad kostar det?", en: "How much does it cost?" },
        { sv: "Kan jag betala med kort?", en: "Can I pay with card?" },
        { sv: "Jag letar efter...", en: "I'm looking for..." },
        { sv: "Har ni...?", en: "Do you have...?" },
        { sv: "Kan jag f√• kvittot?", en: "Can I get the receipt?" },
        { sv: "Var finns...?", en: "Where is...?" }
      ]
    },
    {
      icon: "üöå", title: "Kollektivtrafik (Public transport)",
      phrases: [
        { sv: "Var ligger bussh√•llplatsen?", en: "Where is the bus stop?" },
        { sv: "Vilken buss g√•r till...?", en: "Which bus goes to...?" },
        { sv: "Jag vill √•ka till...", en: "I want to go to..." },
        { sv: "Hur l√•ng tid tar det?", en: "How long does it take?" },
        { sv: "M√•ste jag byta?", en: "Do I need to change?" },
        { sv: "N√§sta h√•llplats, tack.", en: "Next stop, please." }
      ]
    },
    {
      icon: "üè¢", title: "P√• Arbetsf√∂rmedlingen (At the employment office)",
      phrases: [
        { sv: "Jag s√∂ker arbete.", en: "I'm looking for work." },
        { sv: "Jag √§r inskriven p√• Arbetsf√∂rmedlingen.", en: "I'm registered at the employment office." },
        { sv: "Jag vill boka ett m√∂te.", en: "I want to book a meeting." },
        { sv: "Vilka jobb finns det?", en: "What jobs are available?" },
        { sv: "Jag beh√∂ver hj√§lp med mitt CV.", en: "I need help with my CV." },
        { sv: "Kan ni hj√§lpa mig?", en: "Can you help me?" }
      ]
    },
    {
      icon: "üè´", title: "I skolan (At school)",
      phrases: [
        { sv: "Jag f√∂rst√•r inte.", en: "I don't understand." },
        { sv: "Kan du upprepa?", en: "Can you repeat?" },
        { sv: "Vad betyder det?", en: "What does it mean?" },
        { sv: "Hur stavar man...?", en: "How do you spell...?" },
        { sv: "Kan du prata l√•ngsammare?", en: "Can you speak more slowly?" },
        { sv: "Jag har en fr√•ga.", en: "I have a question." }
      ]
    },
    {
      icon: "üìû", title: "I telefon (On the phone)",
      phrases: [
        { sv: "Hej, jag ringer ang√•ende...", en: "Hi, I'm calling regarding..." },
        { sv: "Kan jag prata med...?", en: "Can I speak with...?" },
        { sv: "Kan du stava det?", en: "Can you spell that?" },
        { sv: "Jag ringer tillbaka.", en: "I'll call back." },
        { sv: "Tack f√∂r samtalet.", en: "Thank you for the call." },
        { sv: "Hej d√•!", en: "Goodbye!" }
      ]
    },
    {
      icon: "üè¶", title: "P√• banken (At the bank)",
      phrases: [
        { sv: "Jag vill √∂ppna ett konto.", en: "I want to open an account." },
        { sv: "Jag beh√∂ver ett bankkort.", en: "I need a bank card." },
        { sv: "Vad √§r mitt saldo?", en: "What is my balance?" },
        { sv: "Jag vill √∂verf√∂ra pengar.", en: "I want to transfer money." },
        { sv: "Kan jag ta ut pengar?", en: "Can I withdraw money?" },
        { sv: "Jag har tappat mitt kort.", en: "I've lost my card." }
      ]
    }
  ]
};

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// RENDER FUNCTIONS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const app = document.getElementById('app');

function showHome() {
  setActiveTab('home');
  state.currentView = 'home';
  app.innerHTML = `
    <div class="hero">
      <div class="hero-content slide-up">
        <h2>Learn Swedish the <em>SFI Way</em></h2>
        <p>Free interactive lessons aligned with Sweden's SFI curriculum. Practice vocabulary, grammar, reading, and conversation skills ‚Äî from absolute beginner to advanced.</p>
        <div class="hero-levels">
          ${['A','B','C','D'].map(l => {
            const labels = { A: 'Nyb√∂rjare', B: 'Grundl√§ggande', C: 'Mellanliggande', D: 'Avancerad' };
            const descs = { A: 'Alphabet, greetings, numbers', B: 'Daily life, food, weather', C: 'Work, health, housing', D: 'Society, writing, reading' };
            return `<div class="level-card" onclick="showLevel('${l}')">
              <div class="level-letter">Kurs ${l}</div>
              <div class="level-name">${labels[l]}</div>
              <div class="level-desc">${descs[l]}</div>
            </div>`;
          }).join('')}
        </div>
      </div>
    </div>
    <div class="main">
      <div class="section-header">
        <h2>V√§lkommen! üá∏üá™</h2>
        <p>Choose your SFI level above or explore everyday phrases below.</p>
      </div>
      <div class="tip-box">
        <span class="tip-icon">üí°</span>
        <p><strong>What is SFI?</strong> Svenska f√∂r invandrare (Swedish for Immigrants) is Sweden's free language program with 4 levels: A (beginner) through D (advanced). Each level builds on the previous one, preparing you for everyday life and work in Sweden.</p>
      </div>
      <div style="margin-top: 32px;">
        <div class="section-header">
          <h2>Quick Start Phrases</h2>
          <p>Essential Swedish phrases you'll use every day.</p>
        </div>
        <div class="topic-grid">
          ${phrasesData.categories.slice(0, 3).map(cat => `
            <div class="topic-card" onclick="showPhrases()">
              <div class="topic-icon">${cat.icon}</div>
              <h3>${cat.title}</h3>
              <p>${cat.phrases.slice(0, 2).map(p => p.sv).join(' ¬∑ ')}</p>
              <div class="topic-meta"><span>${cat.phrases.length} phrases</span></div>
            </div>
          `).join('')}
        </div>
      </div>
    </div>
  `;
}

function showLevel(level) {
  setActiveTab(level);
  state.currentView = 'level';
  const data = courseData[level];
  app.innerHTML = `
    <div class="main fade-in">
      <div class="breadcrumb">
        <a onclick="showHome()">Hem</a> <span>‚Ä∫</span> <span>Kurs ${level}</span>
      </div>
      <div class="section-header">
        <h2>${data.name}</h2>
        <p>${data.desc}</p>
      </div>
      <div class="topic-grid">
        ${data.topics.map(topic => `
          <div class="topic-card" onclick="showLesson('${level}', '${topic.id}')">
            <div class="topic-icon">${topic.icon}</div>
            <h3>${topic.title}</h3>
            <p>${topic.desc}</p>
            <div class="topic-meta">
              ${topic.tags.map(t => `<span>${t}</span>`).join('')}
            </div>
          </div>
        `).join('')}
      </div>
    </div>
  `;
}

function showLesson(level, topicId) {
  const data = courseData[level];
  const topic = data.topics.find(t => t.id === topicId);
  if (!topic) return;

  const sections = ['vocabulary', 'dialogue', 'grammar', 'exercises', 'flashcards'];
  const sectionLabels = {
    vocabulary: 'üìö Vocabulary',
    dialogue: 'üí¨ Dialogue',
    grammar: 'üìê Grammar',
    exercises: '‚úèÔ∏è Exercises',
    flashcards: 'üÉè Flashcards'
  };

  app.innerHTML = `
    <div class="main fade-in">
      <div class="breadcrumb">
        <a onclick="showHome()">Hem</a> <span>‚Ä∫</span>
        <a onclick="showLevel('${level}')">Kurs ${level}</a> <span>‚Ä∫</span>
        <span>${topic.title}</span>
      </div>
      <div class="lesson-container">
        <div class="lesson-sidebar">
          <h3>Sections</h3>
          ${sections.map((s, i) => `
            <div class="sidebar-item ${i === 0 ? 'active' : ''}" onclick="showSection('${level}','${topicId}','${s}', this)">
              ${sectionLabels[s]}
            </div>
          `).join('')}
        </div>
        <div class="lesson-content" id="lesson-area">
        </div>
      </div>
    </div>
  `;

  showSection(level, topicId, 'vocabulary', document.querySelector('.sidebar-item'));
}

function showSection(level, topicId, section, el) {
  if (el) {
    document.querySelectorAll('.sidebar-item').forEach(s => s.classList.remove('active'));
    el.classList.add('active');
  }

  const topic = courseData[level].topics.find(t => t.id === topicId);
  const area = document.getElementById('lesson-area');

  switch(section) {
    case 'vocabulary': renderVocabulary(area, topic); break;
    case 'dialogue': renderDialogue(area, topic); break;
    case 'grammar': renderGrammar(area, topic); break;
    case 'exercises': renderExercises(area, topic); break;
    case 'flashcards': renderFlashcards(area, topic); break;
  }
}

// ‚îÄ‚îÄ‚îÄ VOCABULARY ‚îÄ‚îÄ‚îÄ
function renderVocabulary(area, topic) {
  area.innerHTML = `
    <h2>${topic.title}</h2>
    <p class="subtitle">Learn the key words and phrases for this topic.</p>
    <table class="vocab-table">
      <thead>
        <tr><th>Svenska</th><th>English</th><th>Pronunciation</th><th></th></tr>
      </thead>
      <tbody>
        ${topic.vocab.map((v, i) => `
          <tr>
            <td class="swedish">${v.sv}</td>
            <td>${v.en}</td>
            <td class="pronunciation">/${v.pron}/</td>
            <td><button class="audio-btn" onclick="speak('${v.sv.replace(/'/g, "\\'")}')" title="Listen">üîä</button></td>
          </tr>
        `).join('')}
      </tbody>
    </table>
    <div class="tip-box">
      <span class="tip-icon">üîä</span>
      <p><strong>Tip:</strong> Click the speaker icon to hear the pronunciation. Practice saying each word out loud!</p>
    </div>
  `;
}

function speak(text) {
  const utterance = new SpeechSynthesisUtterance(text);
  utterance.lang = 'sv-SE';
  utterance.rate = 0.85;
  speechSynthesis.speak(utterance);
}

// ‚îÄ‚îÄ‚îÄ DIALOGUE ‚îÄ‚îÄ‚îÄ
function renderDialogue(area, topic) {
  if (!topic.dialogue) {
    area.innerHTML = `<h2>Dialogue</h2><p class="subtitle">No dialogue available for this lesson yet. Try the vocabulary or exercises!</p>`;
    return;
  }
  area.innerHTML = `
    <h2>Dialogue Practice</h2>
    <p class="subtitle">Read and listen to this conversation. Click üîä to hear each line.</p>
    <div class="dialogue-box">
      ${topic.dialogue.map(line => `
        <div class="dialogue-line">
          <div class="dialogue-speaker">${line.speaker}</div>
          <div class="dialogue-text">
            <span class="swedish-line">${line.sv} <button class="audio-btn" onclick="speak('${line.sv.replace(/'/g, "\\'")}')" style="display:inline-flex;width:26px;height:26px;font-size:0.75rem;vertical-align:middle;margin-left:4px">üîä</button></span>
            <span class="english-line">${line.en}</span>
          </div>
        </div>
      `).join('')}
    </div>
    <div class="tip-box">
      <span class="tip-icon">üé≠</span>
      <p><strong>Practice tip:</strong> Try reading the Swedish lines out loud! Cover the English translation and see how much you understand.</p>
    </div>
  `;
}

// ‚îÄ‚îÄ‚îÄ GRAMMAR ‚îÄ‚îÄ‚îÄ
function renderGrammar(area, topic) {
  if (!topic.grammar) {
    area.innerHTML = `<h2>Grammar</h2><p class="subtitle">No grammar notes for this lesson yet.</p>`;
    return;
  }
  const g = topic.grammar;
  area.innerHTML = `
    <h2>Grammar</h2>
    <p class="subtitle">Key grammar rules for this topic.</p>
    <div class="grammar-box">
      <h4>üìê ${g.title}</h4>
      <div class="rule">${g.rule}</div>
      <div class="example">${g.example}</div>
    </div>
    <div class="tip-box">
      <span class="tip-icon">üìù</span>
      <p><strong>Remember:</strong> Don't worry about memorizing all the rules at once. Focus on understanding the pattern and practice with the exercises!</p>
    </div>
  `;
}

// ‚îÄ‚îÄ‚îÄ EXERCISES ‚îÄ‚îÄ‚îÄ
function renderExercises(area, topic) {
  const exercises = topic.exercises;
  let currentQ = 0;
  let score = 0;
  let answered = new Array(exercises.length).fill(false);

  function renderQ() {
    if (currentQ >= exercises.length) {
      const pct = Math.round((score / exercises.length) * 100);
      const cls = pct >= 80 ? 'great' : pct >= 50 ? 'ok' : 'needs-work';
      const msg = pct >= 80 ? 'Utm√§rkt! (Excellent!)' : pct >= 50 ? 'Bra jobbat! (Good job!)' : 'Forts√§tt √∂va! (Keep practicing!)';
      addXP(score * 10);
      if (pct >= 80) addStreak();

      area.innerHTML = `
        <div class="quiz-results slide-up">
          <div class="score-circle ${cls}">
            ${pct}%
            <span class="score-label">${score}/${exercises.length}</span>
          </div>
          <h3>${msg}</h3>
          <p>You earned ${score * 10} XP from this exercise!</p>
          <div class="btn-group" style="justify-content:center">
            <button class="btn btn-primary" onclick="renderExercises(document.getElementById('lesson-area'), window._currentTopic)">Try Again</button>
            <button class="btn btn-secondary" onclick="document.querySelectorAll('.sidebar-item')[4].click()">Flashcards ‚Üí</button>
          </div>
        </div>
      `;
      return;
    }

    const ex = exercises[currentQ];
    const progress = ((currentQ) / exercises.length) * 100;

    let questionHTML = '';
    if (ex.type === 'mc') {
      questionHTML = `
        <div class="exercise-question" id="q-${currentQ}">
          <div class="q-text">${ex.q}</div>
          <div class="options-grid">
            ${ex.options.map((opt, i) => `
              <button class="option-btn" onclick="checkMC(${currentQ}, ${i}, ${ex.answer})" id="opt-${currentQ}-${i}">${opt}</button>
            `).join('')}
          </div>
          <div id="feedback-${currentQ}"></div>
        </div>
      `;
    } else if (ex.type === 'fill') {
      questionHTML = `
        <div class="exercise-question" id="q-${currentQ}">
          <div class="q-text">${ex.q.replace('___', '<span class="blank" id="blank-${currentQ}">?</span>')}</div>
          ${ex.hint ? `<div style="font-size:0.85rem;color:var(--text-light);margin-bottom:12px">Hint: ${ex.hint}</div>` : ''}
          <div style="display:flex;gap:10px">
            <input type="text" class="text-input" id="fill-${currentQ}" placeholder="Type your answer..." onkeydown="if(event.key==='Enter')checkFill(${currentQ},'${ex.answer.replace(/'/g, "\\'")}')">
            <button class="btn btn-primary" onclick="checkFill(${currentQ},'${ex.answer.replace(/'/g, "\\'")}')">Check</button>
          </div>
          <div id="feedback-${currentQ}"></div>
        </div>
      `;
    }

    area.innerHTML = `
      <h2>Exercises</h2>
      <p class="subtitle">Question ${currentQ + 1} of ${exercises.length}</p>
      <div class="progress-bar"><div class="progress-fill" style="width:${progress}%"></div></div>
      <div class="exercise-block">
        ${questionHTML}
      </div>
    `;

    if (ex.type === 'fill') {
      setTimeout(() => document.getElementById(`fill-${currentQ}`)?.focus(), 100);
    }
  }

  window.checkMC = function(qIdx, selected, correct) {
    if (answered[qIdx]) return;
    answered[qIdx] = true;

    const qEl = document.getElementById(`q-${qIdx}`);
    const feedbackEl = document.getElementById(`feedback-${qIdx}`);

    document.querySelectorAll(`#q-${qIdx} .option-btn`).forEach((btn, i) => {
      btn.disabled = true;
      if (i === correct) btn.classList.add('correct-answer');
      if (i === selected && selected !== correct) btn.classList.add('wrong-answer');
    });

    if (selected === correct) {
      score++;
      qEl.classList.add('correct');
      feedbackEl.innerHTML = `<div class="feedback correct">‚úÖ R√§tt! (Correct!)</div>`;
    } else {
      qEl.classList.add('wrong');
      feedbackEl.innerHTML = `<div class="feedback wrong">‚ùå Fel ‚Äî the answer is: ${exercises[qIdx].options[correct]}</div>`;
    }

    setTimeout(() => { currentQ++; renderQ(); }, 1500);
  };

  window.checkFill = function(qIdx, correctAnswer) {
    if (answered[qIdx]) return;
    const input = document.getElementById(`fill-${qIdx}`);
    const value = input.value.trim();
    if (!value) return;

    answered[qIdx] = true;
    const qEl = document.getElementById(`q-${qIdx}`);
    const feedbackEl = document.getElementById(`feedback-${qIdx}`);
    const blankEl = document.getElementById(`blank-${qIdx}`);

    input.disabled = true;

    if (value.toLowerCase() === correctAnswer.toLowerCase()) {
      score++;
      qEl.classList.add('correct');
      if (blankEl) blankEl.textContent = correctAnswer;
      feedbackEl.innerHTML = `<div class="feedback correct">‚úÖ R√§tt! (Correct!)</div>`;
    } else {
      qEl.classList.add('wrong');
      if (blankEl) blankEl.textContent = correctAnswer;
      feedbackEl.innerHTML = `<div class="feedback wrong">‚ùå Fel ‚Äî the answer is: ${correctAnswer}</div>`;
    }

    setTimeout(() => { currentQ++; renderQ(); }, 1500);
  };

  window._currentTopic = topic;
  renderQ();
}

// ‚îÄ‚îÄ‚îÄ FLASHCARDS ‚îÄ‚îÄ‚îÄ
function renderFlashcards(area, topic) {
  let idx = 0;
  let flipped = false;
  const cards = [...topic.vocab].sort(() => Math.random() - 0.5);

  function render() {
    const card = cards[idx];
    area.innerHTML = `
      <h2>Flashcards</h2>
      <p class="subtitle">Click the card to flip! Practice all ${cards.length} words.</p>
      <div class="flashcard-counter">${idx + 1} / ${cards.length}</div>
      <div class="flashcard-container">
        <div class="flashcard ${flipped ? 'flipped' : ''}" onclick="flipCard()">
          <div class="flashcard-front">
            <div class="word">${card.sv}</div>
            <div class="hint">Click to reveal</div>
          </div>
          <div class="flashcard-back">
            <div class="translation">${card.en}</div>
            <div class="extra">/${card.pron}/</div>
          </div>
        </div>
      </div>
      <div class="flashcard-controls">
        <button class="btn btn-secondary" onclick="prevCard()" ${idx === 0 ? 'disabled' : ''}>‚Üê Previous</button>
        <button class="btn btn-primary" onclick="nextCard()" ${idx >= cards.length - 1 ? 'disabled' : ''}>Next ‚Üí</button>
      </div>
      <div style="text-align:center;margin-top:16px">
        <button class="btn btn-yellow" onclick="shuffleCards()">üîÄ Shuffle</button>
      </div>
    `;
  }

  window.flipCard = function() { flipped = !flipped; render(); };
  window.nextCard = function() { if (idx < cards.length - 1) { idx++; flipped = false; render(); } };
  window.prevCard = function() { if (idx > 0) { idx--; flipped = false; render(); } };
  window.shuffleCards = function() { cards.sort(() => Math.random() - 0.5); idx = 0; flipped = false; render(); };

  render();
}

// ‚îÄ‚îÄ‚îÄ PHRASES VIEW ‚îÄ‚îÄ‚îÄ
function showPhrases() {
  setActiveTab('phrases');
  state.currentView = 'phrases';
  app.innerHTML = `
    <div class="main fade-in">
      <div class="breadcrumb">
        <a onclick="showHome()">Hem</a> <span>‚Ä∫</span> <span>Vardagsfraser (Everyday Phrases)</span>
      </div>
      <div class="section-header">
        <h2>Vardagsfraser ‚Äî Everyday Phrases</h2>
        <p>Practical phrases for real-life situations in Sweden. Click üîä to hear the pronunciation.</p>
      </div>
      ${phrasesData.categories.map(cat => `
        <div style="margin-bottom:32px">
          <h3 style="font-size:1.2rem;margin-bottom:16px">${cat.icon} ${cat.title}</h3>
          <div style="display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:12px">
            ${cat.phrases.map(p => `
              <div style="background:white;padding:16px 20px;border-radius:10px;box-shadow:var(--shadow);display:flex;align-items:center;gap:12px;border:1px solid rgba(0,0,0,0.04)">
                <button class="audio-btn" onclick="speak('${p.sv.replace(/'/g, "\\'")}')" style="flex-shrink:0">üîä</button>
                <div>
                  <div style="font-weight:600;color:var(--blue-dark)">${p.sv}</div>
                  <div style="font-size:0.85rem;color:var(--text-light)">${p.en}</div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `).join('')}
    </div>
  `;
}

// ‚îÄ‚îÄ‚îÄ INIT ‚îÄ‚îÄ‚îÄ
showHome();
</script>
</body>
</html>
